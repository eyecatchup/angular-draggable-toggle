/*!**********************************************************************
 *  (c) 2015 Stephan Schmitz <eyecatchup@gmail.com>
 *  AngularJS Draggable Toggle Buttons
 *  @version: 0.0.2
 *  @url: <https://github.com/eyecatchup/angular-draggable-toggle/>
 *  @license: MIT license <http://eyecatchup.mit-license.org>
 *  This copyright notice MUST APPEAR in all copies of the script!
 ***********************************************************************/
!function(e){var t=function(t){var o=e.Toggles=function(e,o){var n=this;if("boolean"==typeof o&&e.data("toggles"))return void e.data("toggles").toggle(o);for(var i=["on","drag","click","width","height","animate","type","checkbox","handleWidth"],l={},s=0;s<i.length;s++){var a=e.data("toggle-"+i[s]);"undefined"!=typeof a&&(l[i[s]]=a)}o=n.opts=t.extend({drag:!0,click:!0,text:{on:"ON",off:"OFF"},on:!1,animate:250,checkbox:null,clicker:null,handleWidth:100,width:200,height:50,type:"compact",event:"toggle",touch:!1},o||{},l),n.el=e,e.data("toggles",n),n.selectType="select"===o.type,n.checkbox=t(o.checkbox),o.clicker&&(n.clicker=t(o.clicker)),o.handleWidth&&(n.handleWidth=t(o.handleWidth)),n.mouseDown=o.touch?"mousedown touchstart":"mousedown",n.mouseMove=o.touch?"mousemove touchmove":"mousemove",n.mouseLeave=o.touch?"mouseleave touchend":"mouseleave",n.mouseUp=o.touch?"mouseup touchend":"mouseup",n.click=o.touch?"click touchstart":"click",n.createEl(),n.bindEvents(),n.active=!o.on,n.toggle(o.on,!0,!0)};o.prototype.createEl=function(){var e=this,o=e.el.height(),n=e.el.width();o||e.el.height(o=e.opts.height),n||e.el.width(n=e.opts.width),e.h=o,e.w=n,e.sliderInnerWidth=e.w,e.handleWidth=e.opts.handleWidth,e.onOffWidth=e.sliderInnerWidth-e.handleWidth,e.labelWidth=e.onOffWidth/2;var i=function(e){return t('<div class="toggle-'+e+'">')};e.els={slide:i("slide"),inner:i("inner"),on:i("on"),off:i("off"),handle:i("handle")};var l=e.handleWidth,s=e.onOffWidth,a=e.selectType;e.els.on.css({height:o,width:s,textIndent:a?"":s/3,lineHeight:o+"px"}).html(e.opts.text.on),e.els.off.css({height:o,width:s,textIndent:a?"":s/3,lineHeight:o+"px"}).html(e.opts.text.off),e.els.handle.css({height:o,width:l,marginLeft:0}),e.els.inner.css({width:2*n-l,marginLeft:a||e.active?0:-n+l}),e.selectType&&(e.els.slide.addClass("toggle-select"),e.el.css("width",2*s),e.els.handle.hide()),e.els.inner.append(e.els.on,e.els.handle,e.els.off),e.els.slide.html(e.els.inner),e.el.html(e.els.slide)},o.prototype.bindEvents=function(){var e=this,t=function(t){t.target===e.els.handle[0]&&e.opts.drag||e.toggle()};!e.opts.click||e.opts.clicker&&e.opts.clicker.has(e.el).length||e.el.on(e.click,t),e.opts.clicker&&e.opts.clicker.on(e.click,t),e.opts.drag&&!e.selectType&&e.bindDrag()},o.prototype.bindDrag=function(){var e,t=this,o=t.onOffWidth/3,n=function(n){if(t.el.off(t.mouseMove),t.els.slide.off(t.mouseLeave),t.els.handle.off(t.mouseUp),!e&&t.opts.click&&"mouseleave"!==n.type)return void t.toggle();var i=t.active?-o>e:e>o;i?t.toggle():t.els.inner.stop().animate({marginLeft:t.active?0:-t.sliderInnerWidth},t.opts.animate/2)},i=-t.w+t.handleWidth;t.els.handle.on(t.mouseDown,function(o){e=0,t.els.handle.off(t.mouseUp),t.els.slide.off(t.mouseLeave);var l=o.pageX;void 0===l&&t.opts.touch===!0&&(l=o.originalEvent.touches[0].pageX),t.el.on(t.mouseMove,t.els.handle,function(o){var n=o.pageX;void 0===n&&t.opts.touch===!0&&(n=o.originalEvent.touches[0].pageX),e=n-l;var s;t.active?(s=e,e>0&&(s=0),i>e&&(s=i)):(s=e+i,0>e&&(s=i),e>-i&&(s=0)),t.els.inner.css("margin-left",s)}),t.els.handle.on(t.mouseUp,n),t.els.slide.on(t.mouseLeave,n)})},o.prototype.toggle=function(e,t,o){var n=this;if(n.active!==e){var i=n.active=!n.active;if(n.el.data("toggle-active",i),n.els.off.toggleClass("active",!i),n.els.on.toggleClass("active",i),n.checkbox.prop("checked",i),o||n.el.trigger(n.opts.event,i),!n.selectType){var l=i?0:-n.w+n.handleWidth;n.els.inner.stop().animate({marginLeft:l},t?0:n.opts.animate)}}},t.fn.toggles=function(e){return this.each(function(){new o(t(this),e)})}};"function"==typeof define&&define.amd?define(["jquery"],t):t(e.jQuery||e.Zepto||e.ender||e.$||$)}(this);